{# TODO: 
    ! move Ad variable into global variable settings 
    ! add subscription box if there is no ad
    ! get away with the divider method
#}  

{% minify %}
{# -------------------  query ------------------- #}
{% set categoryId = categoryId ?? null %}
{% set offset = offset ?? 0 %}
{% set limit = limit ?? 5 %}

{% set entriesQuery = craft.entries({
    relatedTo: categoryId,
    section : 'story',
    offset: offset,
    limit: limit,
    with: [
        'storyHeroImage',
        'storyCategory',
        'storyPrintIssue',
        'storyByline'
    ]
}) %}

{% set entries = entriesQuery.all() %}

{# -------------------  content  ------------------- #}


{% embed "_containers/_container"%}
{% block content %}
<div class="flex items-start my-12 md:space-x-6 lg:space-x-12">
    <div class="w-full divide-y divide-primary-300 md:w-auto">
        {% for entry in entries %}
            <div class="py-6">
                {% include "_stories/_story-listing" with { 'entry':entry } %}
            </div>
        {% endfor %}
    </div>
    <div class="sticky hidden w-full md:block " style="top:96px; width: 300px" >
        {% include '_components/_adblock' with {'adgroup': 'halfPageMediumRectangle'} %}
    </div>
</div>
{% endblock %}
{% endembed %}

{# =================== Load more Ad ======================== #}
{% if entries %}
<div s-target="this" s-swap="afterend" sprig s-trigger="revealed">
    {% include '_components/_adblock' with {'adgroup': 'billboardLeaderboard'} %}
    <input type="hidden" name="offset" value="{{ offset + limit }}">
</div>
{% endif %} 

{% endminify %}