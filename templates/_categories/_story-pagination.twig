{# TODO: move some variable into global variable settings #}

{% minify %}
{# -------------------  query ------------------- #}
{% set categoryId = categoryId ?? null %}
{% set offset = offset ?? 0 %}
{% set limit = limit ?? 5 %}

{% set entriesQuery = craft.entries({
    relatedTo: categoryId,
    section : 'story',
    offset: offset,
    limit: limit,
    with: [
        'assetUploadSingleImage',
        'categorySingleCategory',
        'categorySinglePrintIssue',
        'author',
        'userSingleUser'
    ]
}) %}

{% set entries = entriesQuery.all() %}

{% embed "_containers/_container" %}
{% block content %}
<div class="flex items-start my-12 md:space-x-6 lg:space-x-12">
    <div class="w-full divide-y divide-primary-300 md:w-2/3 lg:w-3/4">
        {% for entry in entries %}
            <div class="py-6">
                {% include "_stories/_story-listing" with { 'entry':entry } %}
            </div>
        {% endfor %}
    </div>
    <div class="sticky hidden w-full md:block md:w-1/3 lg:w-1/4" style="top:96px;" >
        {% include '_components/_adblock' with {'adgroup': 'halfPageMediumRectangle'} %}
    </div>
</div>
{% endblock %}
{% endembed %}

{# =================== Load more Ad ======================== #}
{% if entries %}
<div s-target="this" s-swap="afterend" sprig s-trigger="revealed">
    {% include '_components/_adblock' with {'adgroup': 'billboardLeaderboard'} %}
    <input type="hidden" name="offset" value="{{ offset + limit }}">
</div>
{% endif %} 


{% endminify %}